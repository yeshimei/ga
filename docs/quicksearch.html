<html>
<head>
</head>
<body style="background: transparent;">
    <script src="scripts/docstrap.lib.js"></script>
    <script src="scripts/lunr.min.js"></script>
    <script src="scripts/fulltext-search.js"></script>

    <script type="text/x-docstrap-searchdb">
    {"classes.list.html":{"id":"classes.list.html","title":"Classes","body":" DocStrap Classes EventGaRouterTerminal Classes Classes Event Ga Router Terminal × Search results Close Documentation generated by JSDoc 3.6.4 on 2020-06-14T00:42:38+08:00 using the DocStrap template. "},"index.html":{"id":"index.html","title":"Index","body":" DocStrap Classes EventGaRouterTerminal Ga Ga，一个构建交互式命令行界面的库。 API Documentation Installation Usage Router Component Terminal Event Ga 的核心是一个基于按键（组合键）的路由器，当运行命令行脚本时，Ga 将监听键盘事件（keypress），用户通过单击不同按键切换到对应的命令行界面。 它很小，却能轻松配合各种命令行相关库和脑子里奇妙创意，构建出漂亮且强大的交互式命令行应用。 ☞ exmaples/dome 目前，Ga 能做到的事情： 异步（async/await） 动画（ntbl-log ...） 交互式（inquirer，enquirer ...） 插件扩展 Installation npm i @ntbl/ga --save Usage 引入 // index.js const Ga = require('../../src/core') // or import Ga from '@ntbl/ga' 实例化并手动挂载路由 // 引入路由 const router = require('./router') // 实例化 const app = new Ga({ router }) // 手动挂载 app.$mount() 声明路由 // router.js const home = require('./views/home') const summary = require('./views/summary') module.exports = app =&gt; { return { routes: [ { name: 'home', // 挂载路由时，默认路径 path: '/', component: home, }, { name: 'summary', // 挂载路由时，默认路径 path: '/s', component: summary, }, ] } } 编写组件 // views/home.js module.exports = app =&gt; { return '\\n\\n欢迎来到 Ga，这是一个简单的用例' + '\\n\\n请单击按键 s，查看概要' } // views/summary.js module.exports = app =&gt; { return '\\n\\nGa，一个构建交互式命令行界面的库。' + '\\n\\n单击按键 ESC 返回' } 运行脚本 ndoe index.js ☞ exmaples/usage Router Ga 路由（router）与 SPA 单页 web 应用（single page web application）或 web 框架的路由存在以下差异： Ga 路由的路径（path）是一条由按键名（key）组成的链（线性） / // 挂载时，默认路径 /s // 第一步，用户单击按键 s /s/t // 第二步，用户再次单击按键 t /s/t/alt+d // 第三步，用户最后单击组合键 alt+d Ga 路由通过组合键实现页面之间的转跳（非线性） // 无论在任何页面单击组合键 alt+x // 直接转跳到 home 页面 { name: 'home' path: '/', jump: 'alt+x', component: home } Ga 路由的 path 与 jump 支持同时指定多个值。 { name: 'star' path: ['/s', '/c/s'], jump: ['alt+s', 'shift+alt+s'], component: star } 在组件内部，使用 app.$router 上的一些路由方法精确控制页面转跳。 // views/summary.js module.exports = app =&gt; { const { $router } = app // 两秒后，自动返回到首页 setTimeout(function () { $router.push('/') // 或者通过 name // $router.push('home') }, 2000) return '\\n\\nGa，一个构建交互式命令行界面的库。' + '\\n\\n两秒后，自动返回到首页' } ☞ exmaples/router/auto_return 每当页面渲染之前，app.$route 都会更新当前页面的路由信息。这样，我们在页面底部中加入菜单导航。 // views/home.js module.exports = app =&gt; { const { $route } = app const bottomMenu = $route.children.map(route =&gt; `${route.alias}[${route.path[0].key}]`) return '\\n\\n欢迎来到 Ga，这是一个简单的用例' + '\\n\\n' + bottomMenu.join(' | ') } ☞ exmaples/router/bottom_menu Component 组件（component）包含用户编写的业务逻辑与界面视图逻辑。 在一个组件中，一个业务可能有多个分支逻辑并多次更新当前界面的视图。为了让用户极大地保持代码的完整和可控性，视图完全交由用户处理。 比如，我们轻松地配合 inquirer 实现一个账号登陆的组件。 const inquirer = require('inquirer') const log = require('@ntbl/log')() module.exports = async app =&gt; { const { $terminal } = app // 暂停按键事件监听器 // 防止在输入内容时与路由转跳发生冲突 $terminal.pause() console.log('登陆账号：'); const answer = await inquirer.prompt([ { type: 'input', message: 'username:', name: 'user' }, { type: 'password', message: 'password:', name: 'pass' } ]) // 恢复按键事件监听器 $terminal.resume() // 清空命令行界面 $terminal.clear() // loading log.start(data =&gt; `${data.frame} 正在登陆，请稍等！`) // 登陆验证 try { await login(answer.user, answer.pass) log.stop() return '登陆成功，欢迎您' } catch (err) { log.stop() return '登陆失败' } } ☞ exmaples/component/login Terminal app.$terminal 上有一组处理命令行的方法。 clear() - 清空命令行 pause() - 暂停按键事件监听。 在使用第三方交互式库时，必须调用此方法，避免输入内容时与路由转跳之间发生冲突。 resume() - 恢复按键事件监听。 app.$terminal.pause() // 第三方交互库 app.$terminal.resume() Event 在 Ga 实例生命周期里，在不同时期分别会触发以下事件： mount(app) - 在挂载之前触发，仅触发一次。 mounted(app) - 在挂载之后触发，此时，页面已渲染。仅触发一次。 beforeEach(to, from, next) - 在组件每次调用之前触发。 render(route) - 在页面渲染之前触发（注意，当组件未返回任何内容时，此事件不会触发）。 afterEach(to, from) - 在页面渲染之后触发 利用事件，我们为每个页面添加底部导航。 // router.js module.exports = app =&gt; { const { $event } = app $event.on('beforeEach', (to, from, next) =&gt; { const { $route, store } = app const bottomMenu = $route.children.map(route =&gt; `${route.alias}[${route.path[0].key}]`) // store 是一个全局共享数据的存储对象 store.bottomMenu = bottomMenu // beforeEach 事件默认会拦截路由 // next 方法，允许通过 next() }) $event.on('render', route =&gt; { route.template += ('\\n\\n' + app.store.bottomMenu.join(' | ')) }) /* 路由声明 */ } ☞ exmaples/event Documentation 一份由 jsdoc 生成的 API Documentation Issues 遇到任何问题，欢迎提交 Issues License The MIT License (MIT) Copyright (c) 2014-2015 James Shore Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions: The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software. THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE. × Search results Close Documentation generated by JSDoc 3.6.4 on 2020-06-14T00:42:38+08:00 using the DocStrap template. "},"Event.html":{"id":"Event.html","title":"Class: Event","body":" DocStrap Classes EventGaRouterTerminal Class: Event Event new Event() Methods on(name, fn, ctx) 订阅事件 - mount - mounted - beforeEach - afterEach Parameters: Name Type Description name String 事件名 fn function 事件函数 ctx * this 指向 × Search results Close Documentation generated by JSDoc 3.6.4 on 2020-06-14T00:42:38+08:00 using the DocStrap template. "},"Ga.html":{"id":"Ga.html","title":"Class: Ga","body":" DocStrap Classes EventGaRouterTerminal Class: Ga Ga new Ga(options) 一个构建交互式命令行界面应用的库 Parameters: Name Type Description options Object 选项对象 Properties Name Type Description router function 路由 plugins Array 插件 Author: hsy Returns: Type app Members &lt;static&gt; config :object 全局配置对象 Type: object Properties: Name Type Argument Default Description timeout Number &lt;optional&gt; 0 等待转义序列的响应时间 test Boolean &lt;optional&gt; false 测试模式 $event :Event 事件 Type: Event $route 当前路由对象 Properties: Name Type Argument Default Description key String &lt;optional&gt; null 当前路由的触发按键 keys Object &lt;optional&gt; {} 当前路由的触发按键对象 Properties Name Type Argument Default Description name String &lt;optional&gt; null 触发按键的名称 ctrl Boolean &lt;optional&gt; false 触发按键是否包含了 Ctrl 按键 alt Boolean &lt;optional&gt; false 触发按键是否包含了 Alt 按键 shift Boolean &lt;optional&gt; false 触发按键是否包含了 Shift 按键 path String &lt;optional&gt; '/' 当前路由的路径 route Object &lt;optional&gt; {} 当前路由对象（路由列表中匹配当前路径的对象） children Array &lt;optional&gt; [] 当前路由的子路由（拥有多个路径的路由对象，仅返回符合匹配的路径） chain Array &lt;optional&gt; [] 当前路由的路由链对象 $router :Router 路由 Type: Router $terminal :Terminal 终端 Type: Terminal store :Object 公共存储对象，跨组件间共享数据 Type: Object Default Value: {} Methods &lt;async&gt; mount() 挂载路由 &lt;async&gt; render() 渲染页面 × Search results Close Documentation generated by JSDoc 3.6.4 on 2020-06-14T00:42:38+08:00 using the DocStrap template. "},"Router.html":{"id":"Router.html","title":"Class: Router","body":" DocStrap Classes EventGaRouterTerminal Class: Router Router new Router() Methods &lt;async&gt; back() 返回一个页面 &lt;async&gt; forward() 向前一个页面 &lt;async&gt; go() 转跳 n 个页面，n 为正数向前，负数向后 &lt;async&gt; push(path, n) 转跳至指定路径或名字的页面 Parameters: Name Type Default Description path String 路径或名字 n Number 0 当存在多个路径时，指定名字，可选择第几个路径 × Search results Close Documentation generated by JSDoc 3.6.4 on 2020-06-14T00:42:38+08:00 using the DocStrap template. "},"Terminal.html":{"id":"Terminal.html","title":"Class: Terminal","body":" DocStrap Classes EventGaRouterTerminal Class: Terminal Terminal new Terminal() Methods clear() 清除屏幕 pause() 暂停终端监听 resume() 恢复终端监听 × Search results Close Documentation generated by JSDoc 3.6.4 on 2020-06-14T00:42:38+08:00 using the DocStrap template. "}}
    </script>

    <script type="text/javascript">
        $(document).ready(function() {
            Searcher.init();
        });

        $(window).on("message", function(msg) {
            var msgData = msg.originalEvent.data;

            if (msgData.msgid != "docstrap.quicksearch.start") {
                return;
            }

            var results = Searcher.search(msgData.searchTerms);

            window.parent.postMessage({"results": results, "msgid": "docstrap.quicksearch.done"}, "*");
        });
    </script>
</body>
</html>
